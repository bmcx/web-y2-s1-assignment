(this["webpackJsonpweb-y2-s1-assignment"]=this["webpackJsonpweb-y2-s1-assignment"]||[]).push([[0],{427:function(e,t,a){},428:function(e,t,a){},434:function(e,t,a){"use strict";a.r(t);var r=a(4),s=a(0),c=a(2),n=a.n(c),o=a(29),l=a.n(o),i=a(13),d=a(9),u=a(234),b=a(69),j=a(7),x=a(70);a(435),a(424),a(436);x.a.initializeApp({apiKey:"AIzaSyDtBGY3rAXmI26cvv2UhEcgEoATlj1hxO8",authDomain:"sell-harvest.firebaseapp.com",projectId:"sell-harvest",storageBucket:"sell-harvest.appspot.com",messagingSenderId:"815309864182",appId:"1:815309864182:web:a058b6f323b0eeb7b140d7"}),x.a.firestore().settings({});var h=x.a,m=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,445)).then((function(t){var a=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,n=t.getTTFB;a(e),r(e),s(e),c(e),n(e)}))},f=a(47),O={LOGIN_SUCCESS:"AUTH_LOGIN_SUCCESS",LOGIN_ERROR:"AUTH_LOGIN_ERROR",GOOGLE_LOGIN_SUCCESS:"AUTH_GOOGLE_LOGIN_ERROR",GOOGLE_LOGIN_ERROR:"AUTH_GOOGLE_LOGIN_ERROR",SHOW_AUTH_MODAL:"SHOW_AUTH_MODAL",HIDE_AUTH_MODAL:"HIDE_AUTH_MODAL",SHOW_HARVEST_MODAL:"SHOW_HARVEST_MODAL",HIDE_HARVEST_MODAL:"HIDE_HARVEST_MODAL",SIGN_UP_SUCCESS:"SIGN_UP_SUCCESS",SIGN_UP_ERROR:"SIGN_UP_ERROR",RESET_AUTH_ERROR:"RESET_AUTH_ERROR",SIGN_OUT_SUCCESS:"SIGN_OUT_SUCCESS",SIGN_OUT_ERROR:"SIGN_OUT_ERROR",PROFILE_COMPLETE_SUCCESS:"PROFILE_COMPLETE_SUCCESS",PROFILE_COMPLETE_ERROR:"PROFILE_COMPLETE_ERROR",SEND_MESSAGE_SUCCESS:"SEND_MESSAGE_SUCCESS",SEND_MESSAGE_ERROR:"SEND_MESSAGE_ERROR",ADD_HARVEST_SUCCESS:"ADD_HARVEST_SUCCESS",ADD_HARVEST_ERROR:"ADD_HARVEST_ERROR",RATE_HARVEST_SUCCESS:"RATE_HARVEST_SUCCESS",RATE_HARVEST_ERROR:"RATE_HARVEST_ERROR",EDIT_HARVEST_SUCCESS:"EDIT_HARVEST_SUCCESS",EDIT_HARVEST_ERROR:"EDIT_HARVEST_ERROR",DELETE_HARVEST_SUCCESS:"DELETE_HARVEST_SUCCESS",DELETE_HARVEST_ERROR:"DELETE_HARVEST_ERROR"},p={authError:null,authModalVisible:!1,harvestModalVisible:!1},g=function(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,s=arguments.length>1?arguments[1]:void 0,c=null!==(e=null===s||void 0===s||null===(t=s.err)||void 0===t?void 0:t.message)&&void 0!==e?e:"There was an error!";switch(s.type){case O.LOGIN_SUCCESS:return Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!1});case O.LOGIN_ERROR:return f.b.error(c),Object(r.a)(Object(r.a)({},a),{},{authError:c});case O.SIGN_UP_SUCCESS:return window.location.reload(),Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!1});case O.SIGN_UP_ERROR:return f.b.error(c),Object(r.a)(Object(r.a)({},a),{},{authError:c});case O.SIGN_OUT_SUCCESS:return f.b.success("Signed out successfully"),Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!1});case O.SIGN_OUT_ERROR:return f.b.error(c),Object(r.a)(Object(r.a)({},a),{},{authError:null});case O.GOOGLE_LOGIN_SUCCESS:return Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!1});case O.GOOGLE_LOGIN_ERROR:return f.b.error(c),Object(r.a)(Object(r.a)({},a),{},{authError:null});case O.SHOW_AUTH_MODAL:return Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!0});case O.HIDE_AUTH_MODAL:return Object(r.a)(Object(r.a)({},a),{},{authError:null,authModalVisible:!1});case O.SHOW_HARVEST_MODAL:return Object(r.a)(Object(r.a)({},a),{},{harvestModalVisible:!0});case O.HIDE_HARVEST_MODAL:return Object(r.a)(Object(r.a)({},a),{},{harvestModalVisible:!1});case O.RESET_AUTH_ERROR:case O.PROFILE_COMPLETE_SUCCESS:case O.PROFILE_COMPLETE_ERROR:return Object(r.a)(Object(r.a)({},a),{},{authError:null});case O.ADD_HARVEST_SUCCESS:return Object(r.a)(Object(r.a)({},a),{},{harvestModalVisible:!1});case O.ADD_HARVEST_ERROR:return f.b.error(c),Object(r.a)({},a);default:return a}},v=Object(i.c)({auth:g,firestore:b.firestoreReducer,firebase:j.firebaseReducer}),y=(a(426),a(427),a(428),a(14)),w=a(22),N=a(71),E=a(3),S=a(18),C=a.n(S),k=a(30),_=a.n(k),R=a(440),L=a(444),A=a(441),T=a(442),I=a(443),M=function(e){var t=Object(c.useState)(e.initialValue),a=Object(E.a)(t,2),r=a[0],n=a[1];return Object(s.jsxs)("div",{className:"flex flex-row content-center",children:[Object(s.jsx)("p",{className:"block text-sm pr-1 font-bold text-gray-600",children:"".concat(e.label)}),Object(s.jsx)("div",{className:"w-10 h-6 flex rounded-lg p-1 cursor-pointer ease-out duration-200  ".concat(r?"bg-green-600":"bg-gray-300"),onClick:function(){var t=!r;n(t),e.setValue(t)},children:Object(s.jsx)("div",{className:"bg-white w-4 h-4 rounded-md shadow-md transform transition-all ease-out duration-200 ".concat(r?"translate-x-4":"")})})]})},H=a(37),D=a(8),F=a.n(D),U=a(15),V=function(e){var t=e.name,a=e.color,r=e.onClick;return Object(s.jsx)("div",{onClick:r,className:"".concat(a," text-white font-lato px-2 py-1 text-2xs uppercase rounded-lg my-auto"),children:t})},G=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsx)("svg",{className:"stroke-current ".concat(a," w-6 m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},P=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current ".concat(a," w-6 m-auto"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},W=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsxs)("svg",{className:"stroke-current ".concat(a," w-6 m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},B=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsx)("svg",{className:"stroke-current ".concat(a," w-6 m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})})},z=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsxs)("svg",{className:"stroke-current ".concat(a," w-full m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})},q=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsx)("svg",{className:"stroke-current ".concat(a," m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},K=function(e){var t=e.colorClass;return Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current ".concat(t," m-auto"),viewBox:"0 0 20 20",fill:"currentColor",children:Object(s.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},J=function(e){var t=e.strokeWidth,a=e.colorClass;return Object(s.jsx)("svg",{className:"stroke-current ".concat(a," m-auto"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},X=function(e){var t=e.strokeWidth,a=void 0===t?5:t,r=e.colorClass;return Object(s.jsx)("svg",{className:"stroke-current ".concat(r," m-auto spinner"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 50 50",children:Object(s.jsx)("circle",{className:"path",cx:"25",cy:"25",r:"20",fill:"none",strokeWidth:a})})},Y=function(e){e.strokeWidth,e.colorClass;return Object(s.jsx)("svg",{className:"text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},Z=function(e){var t=e.strokeWidth,a=void 0===t?2:t;e.colorClass;return Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:a,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})},$=a(157),Q=a.n($),ee=a(43),te=Object(d.b)((function(e){return{auth:e.firebase.auth}}))((function(e){var t,a,n=e.data,o=(e.onClick,e.auth),l=e.searchTerm,i=Object(c.useState)([]),d=Object(E.a)(i,2),u=d[0],b=d[1],x=Object(c.useState)([]),h=Object(E.a)(x,2),m=h[0],f=h[1];Object(c.useEffect)((function(){n.categories&&O(n.categories),n.subcategories&&p(n.subcategories)}),[n.categories,n.subcategories]);var O=function(){var e=Object(U.a)(F.a.mark((function e(t){var a,s,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],s=0;case 2:if(!(s<t.length)){e.next=10;break}return e.next=5,t[s].get();case 5:c=e.sent,a.push(Object(r.a)(Object(r.a)({},c.data()),{},{id:c.documentId}));case 7:s++,e.next=2;break;case 10:b(a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(U.a)(F.a.mark((function e(t){var a,s,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],s=0;case 2:if(!(s<t.length)){e.next=10;break}return e.next=5,t[s].get();case 5:c=e.sent,a.push(Object(r.a)(Object(r.a)({},c.data()),{},{id:c.documentId}));case 7:s++,e.next=2;break;case 10:f(a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsx)(ee.b,{to:"/harvest/".concat(n.id),children:Object(s.jsxs)("div",{className:"flex bg-gray-50 hover:bg-gray-100 shadow content-center space-x-4 cursor-pointer mb-6 hover:shadow-md rounded-2xl pr-2 transition-all duration-200 ease-out",children:[Object(s.jsx)("div",{className:"flex-shrink-0",children:Object(s.jsx)("div",{className:" w-40 h-40 rounded-2xl bg-cover",style:{backgroundImage:'url("'.concat(n.images[0],'")')}})}),Object(s.jsxs)("div",{className:"flex-grow flex flex-col space-y-1 py-1",children:[Object(s.jsxs)("div",{className:"flex-shrink-0",children:[Object(s.jsxs)("div",{className:"flex",children:[Object(s.jsxs)("div",{className:"flex-grow flex space-x-1",children:[u.map((function(e){return Object(s.jsx)(V,{name:e.name,color:e.styles.bgColor},"".concat(n.id,"_").concat(e.id))})),m.map((function(e){return Object(s.jsx)(V,{name:e.name,color:e.styles.bgColor},"".concat(n.id,"_").concat(e.id))})),0===u.length?Object(s.jsx)(V,{name:"Loading ...",color:"bg-gray-300 animate-pulse"},"loading"):null]}),Object(s.jsx)("div",{className:"flex-shrink-0",children:Object(s.jsx)("div",{className:" m-auto"})})]}),Object(s.jsx)("div",{className:"text-gray-700 font-bold text-xl font-lato mt-1 mb-1",children:Object(s.jsx)(Q.a,{highlightClassName:"text-gray-900 bg-gray-200 rounded-md",searchWords:[l],autoEscape:!0,textToHighlight:n.title})}),Object(s.jsxs)("div",{className:"flex text-xs flex-row pb-2 pt-1 text-gray-400",children:[Object(s.jsx)("div",{className:"w-4",children:Object(s.jsx)(z,{strokeWidth:2})}),Object(s.jsx)("div",{className:"self-center",children:Object(s.jsx)(Q.a,{highlightClassName:"text-gray-900 bg-gray-300 rounded",searchWords:[l],autoEscape:!0,textToHighlight:"".concat(Object(j.isEmpty)(o)?"":"".concat(n.address.street,", ")," ").concat(n.address.city,", ").concat(n.address.province)})})]})]}),Object(s.jsxs)("div",{className:"flex-grow flex justify-between items-end",children:[Object(s.jsxs)("div",{className:"flex flex-row items-center",children:[Object(H.a)(Array(null!==(t=n.rating)&&void 0!==t?t:0)).map((function(e,t){return Object(s.jsx)("div",{className:"w-6 h-6",children:Object(s.jsx)(K,{colorClass:"text-yellow-500"})},t)})),Object(H.a)(Array(5-(null!==(a=n.rating)&&void 0!==a?a:0))).map((function(e,t){return Object(s.jsx)("div",{className:"w-5 h-5 text-gray-400 cursor-pointer",children:Object(s.jsx)(q,{})},t)}))]}),Object(s.jsx)("div",{className:"text-gray-400",children:C()(n.created_at.toDate()).fromNow()})]})]})]})})})),ae=a(44),re=function(){return function(){var e=Object(U.a)(F.a.mark((function e(t,a,r){var s,c,n,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.getFirebase,c=s(),n=new c.auth.GoogleAuthProvider,e.prev=3,e.next=6,c.auth().signInWithPopup(n);case 6:o=e.sent,t({type:O.GOOGLE_LOGIN_SUCCESS,res:o}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t({type:O.GOOGLE_LOGIN_ERROR,err:e.t0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,a,r){return e.apply(this,arguments)}}()},se=function(){return function(e){e({type:O.SHOW_AUTH_MODAL})}},ce=function(){return function(e){e({type:O.HIDE_AUTH_MODAL})}},ne=function(){return function(e){e({type:O.SHOW_HARVEST_MODAL})}},oe=function(){return function(e){e({type:O.RESET_AUTH_ERROR})}},le=C()().subtract(7,"days").toDate(),ie=function(e){var t=e.name,a=e.onClick,r=e.active,c=void 0!==r&&r;return Object(s.jsx)("div",{onClick:a,className:"flex select-none justify-center items-center m-1 font-medium \n    py-1 px-2 rounded-lg bg-gray-100 ".concat(c?"text-green-700 bg-gray-200":"text-gray-400 hover:text-green-600 "," hover:shadow-lg shadow-md ease-out duration-400 cursor-pointer transition-all"),children:Object(s.jsx)("div",{className:"text-sm font-bold",children:t})})},de=Object(i.d)(Object(d.b)((function(e){var t,a;return{harvests:null!==(t=e.firestore.ordered.harvests)&&void 0!==t?t:[],categories:null!==(a=e.firestore.ordered.categories)&&void 0!==a?a:[],auth:e.firebase.auth}}),(function(e){return{showHarvestModal:function(){return e(ne())}}})),Object(j.firestoreConnect)((function(e){return[{collection:"harvests",where:[["created_at",">",le]],orderBy:["created_at","desc"]},{collection:"categories",orderBy:"score"}]})))((function(e){var t=Object(c.useState)(!0),a=Object(E.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)([]),l=Object(E.a)(o,2),i=l[0],d=l[1],u=Object(c.useState)([]),b=Object(E.a)(u,2),x=b[0],h=b[1],m=Object(c.useState)(null),f=Object(E.a)(m,2),O=f[0],p=f[1],g=Object(c.useState)(null),v=Object(E.a)(g,2),y=v[0],S=v[1],k=Object(c.useState)(!0),H=Object(E.a)(k,2),D=H[0],F=H[1],U=Object(c.useState)(null),V=Object(E.a)(U,2),G=V[0],P=V[1],W=Object(c.useState)([]),B=Object(E.a)(W,2),z=B[0],q=B[1],K=Object(c.useState)(null),J=Object(E.a)(K,2),Y=J[0],$=J[1];Object(c.useEffect)((function(){Object(j.isLoaded)(e.harvests,e.categories)&&(q(e.categories),n(!1)),r||y||O||(h(e.harvests),d(e.harvests))}),[O,r,e,y]);var Q=Object(w.c)(x.length,{from:{marginLeft:0,opacity:0},to:{marginLeft:0,opacity:1}}),ae=Object(c.useMemo)((function(){var e,t;return Object(s.jsxs)(R.a,{center:G?[null===G||void 0===G||null===(e=G.location)||void 0===e?void 0:e.latitude,null===G||void 0===G||null===(t=G.location)||void 0===t?void 0:t.longitude]:[7.8731,80.7718],zoom:9,scrollWheelZoom:!0,whenCreated:$,style:{height:"100vh"},children:[Object(s.jsx)(L.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"}),x.map((function(e){var t,a,r=new _.a.Icon({iconUrl:{vegetableIcon:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",fruitIcon:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png",grainsIcon:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",otherIcon:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-black.png"}[e.mapIconType],shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],tooltipAnchor:[10,-30],popupAnchor:[0,-30],shadowSize:[41,41]});return Object(s.jsxs)(A.a,{icon:r,position:[null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.latitude,null===e||void 0===e||null===(a=e.location)||void 0===a?void 0:a.longitude],children:[Object(s.jsxs)(T.a,{children:[Object(s.jsx)("div",{className:" w-full h-32 rounded-md bg-cover",style:{backgroundImage:'url("'.concat(e.images[0],'")')}}),Object(s.jsx)("div",{className:"text-sm font-bold",children:"".concat(e.title.substring(0,16),"...")}),Object(s.jsx)("div",{className:"text-xs ",children:e.address.city}),Object(s.jsx)("div",{className:"text-gray-400",children:C()(e.created_at.toDate()).fromNow()})]}),Object(s.jsxs)(I.a,{children:[Object(s.jsx)("div",{className:"w-32 h-32 rounded-md bg-cover",style:{backgroundImage:'url("'.concat(e.images[0],'")')}}),Object(s.jsx)("div",{className:"text-sm font-bold",children:"".concat(e.title.substring(0,16),"...")}),Object(s.jsx)("div",{className:"text-xs ",children:e.address.city}),Object(s.jsx)("div",{className:"text-gray-400",children:C()(e.created_at.toDate()).fromNow()}),Object(s.jsx)(ee.b,{to:"/harvest/".concat(e.id),children:"Read more.."})]})]},e.id)}))]})}),[x,G]),re=function(){d(e.harvests),h(e.harvests),S(null),p(null)};return r?Object(s.jsxs)("div",{className:"flex w-full h-full flex-col justify-center items-center",children:[Object(s.jsx)("div",{className:"animate-pulse w-10 h-10 text-gray-500 mb-2",children:Object(s.jsx)(X,{})}),Object(s.jsx)("div",{className:"text-md font-lato animate-pulse text-gray-900",children:"Loading"})]}):Object(s.jsxs)("div",{className:"flex w-full h-full",children:[Object(s.jsxs)("div",{className:"flex-1 pl-4 pr-4 h-full overflow-y-auto",children:[Object(s.jsx)("div",{className:"py-4",children:Object(s.jsxs)("div",{className:"bg-gray-200 flex items-center rounded-2xl shadow-sm",children:[Object(s.jsx)("input",{className:"rounded-2xl w-full py-2 px-6 font-bold text-gray-500 leading-tight bg-gray-200 focus:outline-none",id:"search",type:"text",autoComplete:"off",placeholder:"Search",onChange:function(e){return function(e){e=e.trim();var t,a=[],r=Object(N.a)(i);try{for(r.s();!(t=r.n()).done;){var s=t.value;-1===s.title.toLowerCase().indexOf(e.toLowerCase())&&-1===s.address.city.toLowerCase().indexOf(e.toLowerCase())&&-1===s.address.province.toLowerCase().indexOf(e.toLowerCase())&&-1===s.address.street.toLowerCase().indexOf(e.toLowerCase())||a.push(s)}}catch(c){r.e(c)}finally{r.f()}h(a),S(e)}(e.target.value)}}),Object(s.jsx)("div",{className:"p-2",children:y?Object(s.jsx)("button",{onClick:re,className:"text-gray-500 p-1 hover:text-gray-600 focus:outline-none w-8 h-8 ease-out duration-300",children:"\ud83d\uddd9"}):Object(s.jsx)("button",{className:"text-gray-400 p-1 hover:text-gray-600 focus:outline-none w-8 h-8 ease-out duration-300",children:Object(s.jsx)(Z,{})})})]})}),Object(s.jsxs)("div",{className:"flex mb-8 items-center",children:[Object(s.jsxs)("div",{className:"flex-grow flex space-x-1 items-center",children:[z.map((function(t){return Object(s.jsx)(ie,{name:t.name,active:O===t.id,onClick:function(){return function(t){var a,r=[],s=Object(N.a)(e.harvests);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.categories.find((function(e){return e.id===t}))&&r.push(c)}}catch(n){s.e(n)}finally{s.f()}h(r),d(r),p(O===t?null:t)}(t.id)}},t.id)})),O?Object(s.jsx)("button",{onClick:re,className:"text-xs hover:underline focus:outline-none",children:"Clear filter"}):null]}),Object(s.jsx)("div",{className:"flex-shrink-0 flex space-x-1",children:Object(s.jsx)(M,{label:"Show Map",initialValue:D,setValue:function(e){F(e)}})})]}),y?Object(s.jsxs)("div",{className:"flex content-center mb-8 sticky top-0 bg-gray-50 pb-4 px-2 shadow-sm rounded-b-sm",children:[Object(s.jsxs)("div",{className:"flex-grow flex space-x-1",children:[Object(s.jsx)("h2",{className:"font-bold text-4xl text-gray-700",children:y}),Object(s.jsx)("h4",{className:"text-xl text-gray-400 self-end pl-2 ",children:"".concat(x.length," Result").concat(1!==x.length?"s":"")})]}),Object(s.jsx)("div",{className:"flex-shrink-0 flex space-x-1",children:Object(s.jsx)("div",{className:"my-auto mx-2 p-2 shadow-sm hover:shadow-md rounded-lg cursor-pointer ease-out duration-300",children:Object(s.jsx)("div",{className:"w-6 h-6 ",children:Object(s.jsx)("svg",{className:"text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})})})})]}):null,Object(j.isEmpty)(e.auth)?null:Object(s.jsx)("div",{onClick:function(){return e.showHarvestModal()},className:"font-bold text-gray-500 rounded-md hover:shadow-md text-center px-2 py-1 mb-4 border border-opacity-40 bg-gray-100 duration-300 ease-out cursor-pointer",children:"Add New Harvest"}),Object(s.jsx)("div",{className:"flex flex-col",children:Q.map((function(e,t){return Object(s.jsx)(w.a.div,{style:e,className:"box",onMouseEnter:function(){var e,a,r,s;Y.setView([null===(e=x[t])||void 0===e||null===(a=e.location)||void 0===a?void 0:a.latitude,null===(r=x[t])||void 0===r||null===(s=r.location)||void 0===s?void 0:s.longitude],10),P(x[t])},children:Object(s.jsx)(te,{data:x[t],searchTerm:y})},x[t].id)}))})]}),D?Object(s.jsx)("div",{className:"ml-3 flex-1 bg-gray-300 rounded-2xl overflow-hidden transform",children:ae}):null]})})),ue=a(32),be=a(46),je=a(39),xe=a(38),he=function(e){Object(je.a)(a,e);var t=Object(xe.a)(a);function a(){return Object(ue.a)(this,a),t.apply(this,arguments)}return Object(be.a)(a,[{key:"render",value:function(){var e=this.props.profile;return console.log(e),Object(s.jsxs)("div",{className:"w-full relative mt-4 rounded my-24 overflow-hidden",children:[Object(s.jsxs)("div",{className:"h-64 w-full rounded overflow-hidden relative",children:[Object(s.jsx)("img",{src:"https://images.unsplash.com/photo-1542223189-67a03fa0f0bd?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1504&q=80",alt:"",className:"bg w-full h-full rounded object-cover object-center absolute z-0"}),Object(s.jsxs)("div",{className:"flex flex-col justify-center items-center relative h-full bg-black bg-opacity-50 text-white",children:[Object(s.jsx)("img",{alt:"profile",src:e.photo,className:"h-24 w-24 object-cover object-center rounded"}),Object(s.jsx)("h1",{className:"text-2xl font-semibold",children:"".concat(e.firstName," ").concat(e.lastName)})]})]}),Object(s.jsxs)("div",{className:"grid grid-cols-12 bg-white",children:[Object(s.jsxs)("div",{className:"col-span-12 w-full px-3 py-6 justify-center flex space-x-4 border-b border-solid md:space-x-0 md:space-y-4 md:flex-col md:col-span-2 md:justify-start ",children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{className:"text-xl font-semibold",children:"Help Links"}),Object(s.jsx)("hr",{})]}),Object(s.jsxs)("div",{className:"form-item",children:[Object(s.jsx)("label",{className:"text-l ",children:"Department of Agriculture"}),Object(s.jsx)("input",{type:"text",value:"https://departmentofagriculture.com/",className:"w-full appearance-none text-black text-opacity-50 rounded shadow py-1 px-2 mr-2 focus:outline-none focus:shadow-outline focus:border-blue-200 text-opacity-25 ",disabled:!0})]}),Object(s.jsxs)("div",{className:"form-item",children:[Object(s.jsx)("label",{className:"text-l ",children:" John Keels service "}),Object(s.jsx)("input",{type:"text",value:"https://jhonKellsholdings.com/",className:"w-full appearance-none text-black text-opacity-50 rounded shadow py-1 px-2 mr-2 focus:outline-none focus:shadow-outline focus:border-blue-200 text-opacity-25 ",disabled:!0})]}),Object(s.jsxs)("div",{className:"form-item",children:[Object(s.jsx)("label",{className:"text-l ",children:"Help"}),Object(s.jsx)("input",{type:"text",value:"https://zeis.com/",className:"w-full appearance-none text-black text-opacity-50 rounded shadow py-1 px-2  mr-2 focus:outline-none focus:shadow-outline focus:border-blue-200  ",disabled:!0})]})]}),Object(s.jsx)("div",{className:"col-span-12 md:border-solid md:border-l md:border-black md:border-opacity-25 h-full pb-12 md:col-span-10",children:Object(s.jsx)("div",{className:"px-4 pt-4",children:Object(s.jsxs)("form",{action:"#",className:"flex flex-col space-y-8",children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{className:"text-2xl font-semibold",children:"Profile Information"}),Object(s.jsx)("hr",{})]}),Object(s.jsxs)("div",{className:"form-item",children:[Object(s.jsx)("label",{className:"text-xl ",children:"Full Name"}),Object(s.jsx)("input",{type:"text",value:"".concat(e.firstName," ").concat(e.lastName),className:"w-full appearance-none text-black text-opacity-40 rounded shadow py-1 px-2  mr-2 focus:outline-none focus:shadow-outline focus:border-blue-200",disabled:!0})]}),Object(s.jsxs)("div",{className:"flex flex-col space-y-4 md:space-y-0 md:flex-row md:space-x-4",children:[Object(s.jsxs)("div",{className:"form-item w-full",children:[Object(s.jsx)("label",{className:"text-xl ",children:"Phone"}),Object(s.jsx)("input",{type:"text",value:"".concat(e.phone),className:"w-full appearance-none text-black text-opacity-40 rounded shadow py-1 px-2  mr-2 focus:outline-none focus:shadow-outline focus:border-blue-200",disabled:!0})]}),Object(s.jsxs)("div",{className:"form-item w-full",children:[Object(s.jsx)("label",{className:"text-xl ",children:"NIC"}),Object(s.jsx)("input",{type:"text",value:"".concat(e.nic),className:"w-full appearance-none text-black text-opacity-40 rounded shadow py-1 px-2 mr-2 focus:outliine-none focus:shadow-outline focus:border-blue-200 text-opacity-25",disabled:!0})]})]})]})})})]})]})}}]),a}(c.Component),me=Object(d.b)((function(e){return{profile:e.firebase.profile}}),(function(e){return{}}))(he),fe=function(){return Object(s.jsx)("div",{children:Object(s.jsx)(me,{})})},Oe=a(48),pe=function(e){var t=e.children,a=e.tooltipText,r=n.a.createRef(null);return Object(s.jsxs)("div",{className:"relative flex items-center z-20",onMouseEnter:function(){r.current.style.opacity=1,r.current.style.marginLeft="20px"},onMouseLeave:function(){r.current.style.opacity=0,r.current.style.marginLeft="10px"},children:[Object(s.jsxs)("div",{className:"absolute whitespace-no-wrap uppercase bg-gray-700 text-sm text-gray-50 shadow-md px-4 py-2 rounded flex items-center transition-all duration-150 ",style:{left:"100%",opacity:0,top:"-6px"},ref:r,children:[Object(s.jsx)("div",{className:"bg-gray-100 h-3 w-3 absolute shadow-md",style:{left:"-6px",transform:"rotate(45deg)"}}),a]}),Object(s.jsx)("div",{children:t})]})},ge=function(e){var t=e.auth,a=e.profile,r=e.showAuthModal,n=e.signOut,o=Object(y.f)(),l=!Object(j.isEmpty)(t),i=Object(c.useState)(!0),d=Object(E.a)(i,2),u=d[0],b=d[1],x=function(){l?o.push("/profile"):r(),b(!1)};return Object(s.jsxs)("div",{className:"relative flex-grow-0 flex flex-col items-center mb-6 ",children:[u&&!l?Object(s.jsxs)("div",{className:"absolute w-48 whitespace-no-wrap bg-gray-700 text-white text-sm px-4 py-2 rounded-xl flex items-center transition-all duration-150 ",style:{left:"3.5rem"},children:[Object(s.jsx)("button",{onClick:function(){return b(!1)},className:"absolute bg-gray-500 w-6 h-6 right-1 rounded-lg flex items-center hover:shadow-md justify-center transition-all ease-out duration-400 focus:outline-none",children:"\ud83d\uddd9"}),Object(s.jsx)("div",{className:"bg-gray-700 h-3 w-3 absolute",style:{left:"-6px",transform:"rotate(45deg)"}}),Object(s.jsxs)("div",{children:[Object(s.jsx)("button",{onClick:x,className:"underline animate-pulse hover:text-gray-300 outline-none ease-out duration-150",children:"Sign in"})," ","to get started"]})]}):null,Object(s.jsx)("button",{onClick:x,className:"w-10 h-10 overflow-hidden focus:outline-none bg-gray-600 rounded-full shadow-md hover:shadow-lg ease-out duration-300",children:l?Object(s.jsx)("img",{src:a.photo,alt:"",className:"min-h-full w-max"}):Object(s.jsx)(Y,{})}),l?Object(s.jsx)("button",{onClick:function(){n(),o.push("/")},className:"focus:outline-none text-xs py-1 mt-1 hover:text-gray-500",children:"Sign out"}):null]})},ve=function(e){var t=e.to,a=e.children,c=(e.className,e.activeClassName,Object(Oe.a)(e,["to","children","className","activeClassName"])),n="object"===typeof t?t.pathname:t;return Object(s.jsx)("li",{className:"mb-6",children:Object(s.jsx)(y.a,{path:n,children:function(e){var n,o=t===(null===e||void 0===e||null===(n=e.location)||void 0===n?void 0:n.pathname);return Object(s.jsx)(ee.b,Object(r.a)(Object(r.a)({},c),{},{to:t,children:"function"===typeof a?a(o):a}))}})})},ye=Object(d.b)((function(e){var t;return{users:null!==(t=e.firestore.ordered.users)&&void 0!==t?t:[],auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{showAuthModal:function(){return e(se())},signOut:function(){return e(function(){var e=Object(U.a)(F.a.mark((function e(t,a,r){var s,c,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.getFirebase,c=s(),e.prev=2,e.next=5,c.auth().signOut();case 5:n=e.sent,t({type:O.SIGN_OUT_SUCCESS,res:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t({type:O.SIGN_OUT_ERROR,err:e.t0});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,a,r){return e.apply(this,arguments)}}())}}}))((function(e){var t,a="text-green-600",c="text-gray-400 hover:text-green-600 ease-out duration-500";return Object(s.jsxs)("div",{className:"z-10 w-20 bg-gray-200 rounded-r-lg mr-2 px-4 py-6 flex flex-col items-center",children:[Object(s.jsx)("div",{className:"flex-grow-0 w-10 h-10 bg-green-700 rounded mb-6 shadow-md hover:shadow-lg ease-out duration-300",children:Object(s.jsx)("svg",{className:"text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),Object(s.jsxs)("nav",{className:"my-10 flex-grow",children:[Object(s.jsxs)("ul",{children:[Object(s.jsx)(pe,{tooltipText:"Home",children:Object(s.jsx)(ve,{to:"/",children:function(e){return Object(s.jsxs)("div",{className:"flex content-center",children:[Object(s.jsx)(G,{strokeWidth:2,colorClass:e?a:c}),Object(s.jsx)("div",{className:"w-1 h-1 rounded-sm ".concat(e?"bg-green-600":""," self-center")})]})}})}),Object(s.jsx)(pe,{tooltipText:"Graphs",children:Object(s.jsx)(ve,{to:"/graphs",children:function(e){return Object(s.jsxs)("div",{className:"flex content-center",children:[Object(s.jsx)(P,{strokeWidth:2,colorClass:e?a:c}),Object(s.jsx)("div",{className:"w-1 h-1 rounded-sm ".concat(e?"bg-green-600":""," self-center")})]})}})})]}),"ADMIN"===(null===(t=e.profile)||void 0===t?void 0:t.role)?Object(s.jsx)("ul",{children:Object(s.jsx)(pe,{tooltipText:"Settings",children:Object(s.jsx)(ve,{to:"/settings",children:function(e){return Object(s.jsxs)("div",{className:"flex content-center",children:[Object(s.jsx)(W,{strokeWidth:2,colorClass:e?a:c}),Object(s.jsx)("div",{className:"w-1 h-1 rounded-sm ".concat(e?"bg-green-600":""," self-center")})]})}})})}):null]}),Object(s.jsx)(ge,Object(r.a)({},e)),Object(s.jsx)("div",{className:"flex-grow-0 ",children:Object(s.jsx)(B,{strokeWidth:2,colorClass:"text-gray-400"})})]})})),we=function(e){var t=e.children,a=e.tooltipText,r=n.a.createRef(null);return Object(s.jsxs)("div",{className:"relative flex items-center",children:[Object(s.jsxs)("div",{className:"absolute whitespace-no-wrap bg-gray-700 text-white px-4 py-2 rounded flex items-center transition-all duration-150 w-32",style:{left:"100%",opacity:0},ref:r,children:[Object(s.jsx)("div",{className:"bg-gray-700 h-3 w-3 absolute",style:{left:"-6px",transform:"rotate(45deg)"}}),a]}),Object(s.jsx)("div",{onMouseEnter:function(){r.current.style.opacity=1,r.current.style.marginLeft="20px"},onMouseLeave:function(){r.current.style.opacity=0,r.current.style.marginLeft="10px"},children:t})]})},Ne=function(e){var t=e.id,a=e.labelText,r=e.name,c=e.type,n=e.required,o=void 0!==n&&n,l=e.tooltipText,i=e.onChange,d=e.validationError,u=void 0!==d&&d,b=e.disabled,j=void 0!==b&&b,x=e.autoFocus,h=void 0!==x&&x,m=e.minLength,f=void 0===m?0:m,O=e.maxLength,p=void 0===O?100:O,g=e.defaultValue,v=void 0===g?"":g,y=e.placeholder,w=void 0===y?"":y;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"flex justify-between items-center",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:t,children:a}),Object(s.jsx)("div",{className:"mb-2 text-xs text-gray-500 hover:text-gray-800 focus:outline-none cursor-pointer",children:l?Object(s.jsx)(we,{tooltipText:l,children:Object(s.jsx)("div",{className:"w-4 h-4",children:Object(s.jsx)(J,{strokeWidth:2})})}):null})]}),Object(s.jsx)("input",{id:t,name:r,className:" ".concat(u?"ring-red-400 ring-2 border-red-500":"focus:border-gray-500 focus:ring-gray-300 focus:ring "," bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-4 block w-full transition-all ease-out duration-300"),type:c,onChange:i,disabled:j,autoFocus:h,required:o,minLength:f,maxLength:p,defaultValue:v,placeholder:w})]})},Ee=function(e){var t=e.id,a=e.labelText,r=e.name,n=e.required,o=e.onChange,l=e.validationError,i=e.disabled,d=e.minLength,u=void 0===d?6:d,b=Object(c.useState)("password"),j=Object(E.a)(b,2),x=j[0],h=j[1];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"flex justify-between items-center",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:t,children:a}),Object(s.jsxs)("button",{type:"button",className:"text-xs text-gray-500 hover:underline focus:outline-none cursor-pointer",onClick:function(){return h("password"===x?"text":"password")},children:["password"===x?"Show":"Hide","\xa0password"]})]}),Object(s.jsx)("input",{id:t,name:r,className:" ".concat(l?"ring-red-400 ring-2 border-red-500":"focus:border-gray-500 focus:ring-gray-300 focus:ring "," bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-4 block w-full transition-all ease-out duration-300"),type:x,onChange:o,disabled:i,required:null!==n&&void 0!==n&&n,minLength:u})]})},Se=function(){return Object(s.jsx)("h2",{className:"text-2xl font-black text-gray-700 text-center",children:"Harvest"})},Ce=function(e){var t=e.onClick;return Object(s.jsx)("button",{onClick:t,className:"flex items-center justify-center mt-4 text-white rounded-lg shadow-md hover:bg-gray-100 w-full transition-all ease-out duration-400 focus:outline-none",children:Object(s.jsxs)("div",{className:"px-4 py-3 text-center text-gray-600 font-bold w-full",children:[Object(s.jsxs)("svg",{className:"h-6 w-6 absolute",viewBox:"0 0 40 40",children:[Object(s.jsx)("path",{d:"M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.045 27.2142 24.3525 30 20 30C14.4775 30 10 25.5225 10 20C10 14.4775 14.4775 9.99999 20 9.99999C22.5492 9.99999 24.8683 10.9617 26.6342 12.5325L31.3483 7.81833C28.3717 5.04416 24.39 3.33333 20 3.33333C10.7958 3.33333 3.33335 10.7958 3.33335 20C3.33335 29.2042 10.7958 36.6667 20 36.6667C29.2042 36.6667 36.6667 29.2042 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z",fill:"#FFC107"}),Object(s.jsx)("path",{d:"M5.25497 12.2425L10.7308 16.2583C12.2125 12.59 15.8008 9.99999 20 9.99999C22.5491 9.99999 24.8683 10.9617 26.6341 12.5325L31.3483 7.81833C28.3716 5.04416 24.39 3.33333 20 3.33333C13.5983 3.33333 8.04663 6.94749 5.25497 12.2425Z",fill:"#FF3D00"}),Object(s.jsx)("path",{d:"M20 36.6667C24.305 36.6667 28.2167 35.0192 31.1742 32.34L26.0159 27.975C24.3425 29.2425 22.2625 30 20 30C15.665 30 11.9842 27.2359 10.5975 23.3784L5.16254 27.5659C7.92087 32.9634 13.5225 36.6667 20 36.6667Z",fill:"#4CAF50"}),Object(s.jsx)("path",{d:"M36.3425 16.7358H35V16.6667H20V23.3333H29.4192C28.7592 25.1975 27.56 26.805 26.0133 27.9758C26.0142 27.975 26.015 27.975 26.0158 27.9742L31.1742 32.3392C30.8092 32.6708 36.6667 28.3333 36.6667 20C36.6667 18.8825 36.5517 17.7917 36.3425 16.7358Z",fill:"#1976D2"})]}),"Continue with Google"]})})},ke=Object(d.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signIn:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=s.getFirebase,n=c(),t.prev=2,t.next=5,n.auth().signInWithEmailAndPassword(e.email,e.password);case 5:o=t.sent,a({type:O.LOGIN_SUCCESS,res:o}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),a({type:O.LOGIN_ERROR,err:t.t0});case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))},signInWithGoogle:function(){return e(re())},hideAuthModal:function(){return e(ce())},resetAuthError:function(){return e(oe())}}}))((function(e){var t=Object(c.useState)(!1),a=Object(E.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)(""),l=Object(E.a)(o,2),i=l[0],d=l[1],u=Object(c.useState)(""),b=Object(E.a)(u,2),j=b[0],x=b[1],h=e.authError,m=e.setPage;Object(c.useEffect)((function(){h&&n(!1)}),[h]);return Object(s.jsxs)("div",{className:"bg-gray-50 rounded-lg w-96 shadow-lg p-4 z-20",children:[Object(s.jsx)(Se,{}),Object(s.jsx)("button",{onClick:function(){return e.hideAuthModal()},className:"absolute bg-gray-100 w-8 h-8 top-0 right-0 rounded-lg flex items-center hover:shadow-md justify-center transition-all ease-out duration-400 focus:outline-none",children:"\ud83d\uddd9"}),Object(s.jsx)("p",{className:"text-xl text-gray-600 text-center",children:"Welcome back!"}),Object(s.jsx)(Ce,{onClick:function(){return e.signInWithGoogle()}}),Object(s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"}),Object(s.jsx)("span",{className:"text-xs text-center text-gray-500 uppercase",children:"or sign in with email"}),Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"})]}),Object(s.jsxs)("form",{onSubmit:function(t){t.preventDefault(),n(!0),e.signIn({email:i,password:j})},children:[Object(s.jsx)("div",{className:"mt-4",children:Object(s.jsx)(Ne,{id:"email",labelText:"Email Address",name:"email",type:"email",required:!0,disabled:r,onChange:function(e){d(e.target.value)},validationError:!!h,autoFocus:!0})}),Object(s.jsx)("div",{className:"mt-4",children:Object(s.jsx)(Ee,{id:"password",labelText:"Password",name:"password",type:"password",required:!0,disabled:r,onChange:function(e){x(e.target.value)},validationError:!!h})}),h?Object(s.jsx)("div",{className:"text-xs mt-2 text-center p-2 bg-red-400 rounded-lg text-white",children:h}):null,Object(s.jsx)("div",{className:"mt-6",children:Object(s.jsx)("button",{disabled:r,type:"submit",className:"bg-gray-700 text-white uppercase font-bold py-2 px-4 w-full rounded-lg hover:bg-gray-600 focus:outline-none focus:bg-gray-600 ease-out duration-300",children:r?Object(s.jsx)("div",{className:"w-6 h-6 mx-auto",children:Object(s.jsx)(X,{colorClass:"text-gray-300"})}):"Sign in"})})]}),Object(s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/5 md:w-1/4"}),Object(s.jsx)("button",{onClick:function(){e.resetAuthError(),m("SignUp")},disabled:r,className:"text-xs text-gray-500 uppercase hover:underline focus:outline-none",children:"or sign up"}),Object(s.jsx)("span",{className:"border-b w-1/5 md:w-1/4"})]})]})})),_e=Object(d.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=s.getFirebase,n=c(),t.prev=2,t.next=5,n.auth().createUserWithEmailAndPassword(e.email,e.password);case 5:o=t.sent,localStorage.setItem("firstName",e.firstName),localStorage.setItem("lastName",e.lastName),localStorage.setItem("nic",e.nic),localStorage.setItem("phone",e.phone),localStorage.setItem("email",e.email),localStorage.setItem("uid",o.uid),a({type:O.SIGN_UP_SUCCESS,res:o}),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),a({type:O.SIGN_UP_ERROR,err:t.t0});case 18:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))},signInWithGoogle:function(){return e(re())},hideAuthModal:function(){return e(ce())},resetAuthError:function(){return e(oe())}}}))((function(e){var t=Object(c.useState)(!1),a=Object(E.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)(""),l=Object(E.a)(o,2),i=l[0],d=l[1],u=Object(c.useState)(""),b=Object(E.a)(u,2),j=b[0],x=b[1],h=Object(c.useState)(""),m=Object(E.a)(h,2),f=m[0],O=m[1],p=Object(c.useState)(""),g=Object(E.a)(p,2),v=g[0],y=g[1],w=Object(c.useState)(""),N=Object(E.a)(w,2),S=N[0],C=N[1],k=Object(c.useState)(""),_=Object(E.a)(k,2),R=_[0],L=_[1],A=e.authError;Object(c.useEffect)((function(){A&&n(!1)}),[A]);return Object(s.jsxs)("div",{className:"bg-gray-50 rounded-lg w-96 shadow-lg p-4 z-20",children:[Object(s.jsx)("button",{onClick:function(){return e.hideAuthModal()},className:"absolute bg-gray-100 w-8 h-8 top-0 right-0 rounded-lg flex items-center hover:shadow-md justify-center transition-all ease-out duration-400 focus:outline-none",children:"\ud83d\uddd9"}),Object(s.jsx)(Se,{}),Object(s.jsx)("p",{className:"text-xl text-gray-600 text-center",children:"Welcome!"}),Object(s.jsx)(Ce,{onClick:function(){return e.signInWithGoogle()}}),Object(s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"}),Object(s.jsx)("span",{className:"text-xs text-center text-gray-500 uppercase",children:"or sign up with email"}),Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"})]}),Object(s.jsxs)("form",{onSubmit:function(t){t.preventDefault(),-1!==S.search(/^([0-9]{9}[x|X|v|V]|[0-9]{12})$/)?-1!==R.search(/^(?:0|94|\+94)?(?:(11|21|23|24|25|26|27|31|32|33|34|35|36|37|38|41|45|47|51|52|54|55|57|63|65|66|67|81|912)(0|2|3|4|5|7|9)|7(0|1|2|5|6|7|8)\d)\d{6}$/)?(n(!0),e.signUp({firstName:f,lastName:v,nic:S,phone:R,email:i,password:j})):alert("Check Phone Number"):alert("Check NIC")},children:[Object(s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"firstName",labelText:"First Name",name:"firstName",type:"text",required:!0,disabled:r,onChange:function(e){O(e.target.value)},autoFocus:!0})}),Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"lastName",labelText:"Last Name",name:"lastName",type:"text",required:!0,disabled:r,onChange:function(e){y(e.target.value)}})})]}),Object(s.jsx)("div",{className:"mt-4",children:Object(s.jsx)(Ne,{id:"email",labelText:"Email Address",name:"email",type:"email",required:!0,disabled:r,onChange:function(e){d(e.target.value)},validationError:!!A})}),Object(s.jsx)("div",{className:"mt-4",children:Object(s.jsx)(Ee,{id:"password",labelText:"Password",name:"password",required:!0,disabled:r,onChange:function(e){x(e.target.value)},validationError:!!A})}),Object(s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"nic",labelText:"NIC Number",name:"nic",type:"text",required:!0,tooltipText:"NIC will be used to only confirm your identity",onChange:function(e){C(e.target.value)},minLength:10,disabled:r,maxLength:13})}),Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"phone",labelText:"Phone",name:"phone",type:"text",required:!0,tooltipText:"Phone will be shared with keels staff",onChange:function(e){L(e.target.value)},minLength:10,disabled:r,maxLength:10})})]}),Object(s.jsx)("div",{className:"mt-8",children:Object(s.jsx)("button",{disabled:r,type:"submit",className:"bg-gray-700 text-white uppercase font-bold py-2 px-4 w-full rounded-lg hover:bg-gray-600 focus:outline-none focus:bg-gray-600 ease-out duration-300",children:r?Object(s.jsx)("div",{className:"w-6 h-6 mx-auto",children:Object(s.jsx)(X,{colorClass:"text-gray-300"})}):"Sign Up"})})]}),Object(s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/5 md:w-1/4"}),Object(s.jsx)("button",{onClick:function(){e.resetAuthError(),e.setPage("SignIn")},className:"text-xs text-gray-500 uppercase hover:underline focus:outline-none",children:"or sign in"}),Object(s.jsx)("span",{className:"border-b w-1/5 md:w-1/4"})]})]})})),Re=function(){var e=Object(c.useState)("SignIn"),t=Object(E.a)(e,2),a=t[0],r=t[1],n=Object(w.d)(a,null,{from:{opacity:0,transform:"translateY(-10%)"},enter:{opacity:1,transform:"translateY(0%)"},leave:{opacity:0,transform:"translateY(10%)"}});return Object(s.jsxs)("div",{className:"w-screen h-screen absolute z-20 flex flex-col items-center justify-center",children:[n.map((function(e){var t=e.item,a=e.key,c=e.props;return t&&Object(s.jsx)(w.a.div,{style:c,className:"z-20 absolute",children:"SignIn"===t?Object(s.jsx)(ke,{setPage:r}):Object(s.jsx)(_e,{setPage:r})},a)})),Object(s.jsx)("div",{className:"w-screen h-screen absolute bg-black opacity-40"})]})},Le=function(e){var t=e.authLoaded,a=e.profileLoaded;return Object(s.jsxs)("div",{className:"w-screen h-screen bg-gray-50 flex flex-col justify-center items-center",children:[Object(s.jsx)("div",{className:"animate-pulse w-10 h-10 text-gray-500 mb-10",children:Object(s.jsx)(X,{})}),Object(s.jsxs)("div",{className:"text-md font-lato animate-pulse text-gray-900 text-center",children:[t?"\u2714 Firebase Auth Loaded successfully":"\u2022 Firebase Auth is Loading...",Object(s.jsx)("br",{}),t&&a?"\u2714 User profile loaded successfully":"\u2022 User profile is Loading..."]})]})},Ae=Object(d.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{completeProfile:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o,l,i,d,u,b,j,x,h;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.getFirebase,l=s.getFirestore,i=o(),d=l(),u=r(),b=null===u||void 0===u||null===(c=u.firebase)||void 0===c||null===(n=c.auth)||void 0===n?void 0:n.uid,j=i.storage().ref(),x=j.child("/users/".concat(b,"/profilePicture.png")),t.next=9,x.put(e.photo);case 9:return t.next=11,x.getDownloadURL();case 11:return h=t.sent,t.prev=12,t.next=15,d.collection("users").doc(b).set({firstName:e.firstName,lastName:e.lastName,nic:e.nic,phone:e.phone,photo:h,profileCompleted:!0});case 15:a({type:O.PROFILE_COMPLETE_SUCCESS,res:""}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(12),a({type:O.PROFILE_COMPLETE_ERROR,err:t.t0});case 21:case"end":return t.stop()}}),t,null,[[12,18]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))}}}))((function(e){e.auth;var t,a,n,o,l=e.authError,i=e.completeProfile,d=Object(c.useState)(!1),u=Object(E.a)(d,2),b=u[0],j=u[1],x=Object(c.useState)({preview:"",raw:null}),h=Object(E.a)(x,2),m=h[0],f=h[1],O=Object(c.useState)(null!==(t=localStorage.getItem("firstName"))&&void 0!==t?t:""),p=Object(E.a)(O,2),g=p[0],v=p[1],y=Object(c.useState)(null!==(a=localStorage.getItem("lastName"))&&void 0!==a?a:""),w=Object(E.a)(y,2),N=w[0],S=w[1],C=Object(c.useState)(null!==(n=localStorage.getItem("nic"))&&void 0!==n?n:""),k=Object(E.a)(C,2),_=k[0],R=k[1],L=Object(c.useState)(null!==(o=localStorage.getItem("phone"))&&void 0!==o?o:""),A=Object(E.a)(L,2),T=A[0],I=A[1],M=Object(c.useState)({firstName:!1,lastName:!1,nic:!1,phone:!1,photo:!1}),H=Object(E.a)(M,2),D=H[0],V=H[1];Object(c.useEffect)((function(){l&&j(!1)}),[l]);var G=function(){var e=Object(U.a)(F.a.mark((function e(t){var a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.files||!t.target.files[0]){e.next=5;break}return e.next=3,new Promise((function(e){var a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onload=function(){return e(a.result)}}));case 3:a=e.sent,f({preview:a,raw:t.target.files[0]});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=!1,t=D;return m.raw?t=Object(r.a)(Object(r.a)({},t),{},{photo:!1}):(t=Object(r.a)(Object(r.a)({},t),{},{photo:!0}),e=!0),g.trim().length<1?(t=Object(r.a)(Object(r.a)({},t),{},{firstName:!0}),e=!0):t=Object(r.a)(Object(r.a)({},t),{},{firstName:!1}),N.trim().length<1?(t=Object(r.a)(Object(r.a)({},t),{},{lastName:!0}),e=!0):t=Object(r.a)(Object(r.a)({},t),{},{lastName:!1}),_.trim().length<1?(t=Object(r.a)(Object(r.a)({},t),{},{nic:!0}),e=!0):t=Object(r.a)(Object(r.a)({},t),{},{nic:!1}),T.trim().length<1?(t=Object(r.a)(Object(r.a)({},t),{},{phone:!0}),e=!0):t=Object(r.a)(Object(r.a)({},t),{},{phone:!1}),V(t),e};return Object(s.jsxs)("div",{style:{backdropFilter:"blur(5px)"},className:"w-screen h-screen absolute z-20 flex flex-col items-center justify-center",children:[Object(s.jsxs)("div",{className:"bg-gray-50 rounded-lg shadow-lg p-4 z-20",style:{width:"30rem"},children:[Object(s.jsx)("p",{className:"text-xl text-gray-800 text-center",children:"Welcome Back!"}),Object(s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"}),Object(s.jsx)("span",{className:"text-xs text-center text-gray-500 uppercase",children:"Complete your profile"}),Object(s.jsx)("span",{className:"border-b w-1/5 lg:w-1/4"})]}),Object(s.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=P();console.log(D),t||(j(!0),i({firstName:g,lastName:N,nic:_,phone:T,photo:m.raw}))},children:[Object(s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[Object(s.jsx)("div",{className:"w-1/3",children:Object(s.jsxs)("div",{className:"flex flex-row items-center justify-center",children:[Object(s.jsx)("label",{htmlFor:"photo",children:Object(s.jsx)("div",{className:"".concat(D.photo?"ring-red-400 ring-2 border-red-500":""," w-32 h-32 bg-gray-300 shadow-md overflow-hidden rounded-full flex items-center justify-center"),children:m.preview?Object(s.jsx)("img",{src:m.preview,alt:"profile",className:"min-h-full w-max"}):Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("p",{className:"text-sm text-center",children:"Select a profile photo"})})})}),Object(s.jsx)("input",{hidden:!0,id:"photo",type:"file",onChange:G,accept:"image/jpg"})]})}),Object(s.jsxs)("div",{className:"w-2/3",children:[Object(s.jsx)(Ne,{id:"firstName",labelText:"First Name",name:"firstName",type:"text",required:!0,onChange:function(e){P(),v(e.target.value)},defaultValue:g,validationError:D.firstName}),Object(s.jsx)(Ne,{id:"lastName",labelText:"Last Name",name:"lastName",type:"text",required:!0,onChange:function(e){P(),S(e.target.value)},defaultValue:N,validationError:D.lastName})]})]}),Object(s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"nic",labelText:"NIC Number",name:"nic",type:"text",required:!0,tooltipText:"NIC will be used to only confirm your identity",onChange:function(e){P(),R(e.target.value)},defaultValue:_,validationError:D.nic,minLength:10,maxLength:13})}),Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Ne,{id:"phone",labelText:"Phone",name:"phone",type:"text",required:!0,tooltipText:"Phone will be shared with keels staff",onChange:function(e){P(),I(e.target.value)},defaultValue:[T],validationError:D.phone,minLength:10,maxLength:10})})]}),Object(s.jsx)("div",{className:"mt-8",children:Object(s.jsx)("button",{type:"submit",className:"bg-gray-700 text-white uppercase font-bold py-2 px-4 w-full rounded-lg hover:bg-gray-600 focus:outline-none focus:bg-gray-600 ease-out duration-300",children:b?Object(s.jsx)("div",{className:"w-6 h-6 mx-auto",children:Object(s.jsx)(X,{colorClass:"text-gray-300"})}):"Sign in"})})]})]}),Object(s.jsx)("div",{className:"w-screen h-screen absolute bg-black opacity-40"})]})})),Te=Object(i.d)(Object(d.b)((function(e,t){return{id:t.id,user:e.firestore.data["".concat(t.id,"_user")],auth:e.firebase.auth}}),(function(e){return{}})),Object(j.firestoreConnect)((function(e){return[{collection:"users",doc:e.id,storeAs:"".concat(e.id,"_user")}]})))((function(e){var t=e.user,a=e.address,r=Object(c.useState)(!0),n=Object(E.a)(r,2),o=n[0],l=n[1];return Object(c.useEffect)((function(){Object(j.isLoaded)(t)&&l(!1)}),[t]),o?Object(s.jsx)("div",{children:"Loading.."}):Object(s.jsxs)("div",{className:"flex flex-row space-x-2 items-center",children:[Object(s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-cover ",style:{backgroundImage:'url("'.concat(null===t||void 0===t?void 0:t.photo,'")')}}),Object(s.jsxs)("div",{className:"flex flex-col",children:[Object(s.jsx)("div",{className:"text-gray-800",children:"".concat(null===t||void 0===t?void 0:t.firstName," ").concat(null===t||void 0===t?void 0:t.lastName)}),a]})]})})),Ie=Object(i.d)(Object(d.b)((function(e,t){return{id:t.id,user:e.firestore.data["".concat(t.message.id,"_user")],auth:e.firebase.auth}}),(function(e){return{}})),Object(j.firestoreConnect)((function(e){return[{collection:"users",doc:e.message.user.id,storeAs:"".concat(e.message.id,"_user")}]})))((function(e){var t=e.user,a=e.message,r=Object(c.useState)(!0),n=Object(E.a)(r,2),o=n[0],l=n[1];return Object(c.useEffect)((function(){Object(j.isLoaded)(t)&&l(!1)}),[t]),o?Object(s.jsx)("div",{className:"px-2 py-1 m-1 border border-opacity-40 bg-gray-100 rounded-md text-justify",children:"Loading.."}):Object(s.jsxs)("div",{className:"flex flex-row space-x-2 items-start mb-6",children:[Object(s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-cover flex-shrink-0",style:{backgroundImage:'url("'.concat(t.photo,'")')}}),Object(s.jsxs)("div",{className:"flex flex-col w-full",children:[Object(s.jsxs)("div",{className:"flex flex-row justify-between items-center space-x-1",children:[Object(s.jsx)("div",{className:"text-sm text-gray-600",children:"".concat(t.firstName," ").concat(t.lastName," ").concat(t.role?"[".concat(t.role," STAFF]"):"")}),Object(s.jsx)("div",{className:"text-sm text-gray-600",children:"replied ".concat(C()(a.created_at.toDate()).fromNow())})]}),Object(s.jsx)("div",{className:"px-2 py-1 m-1 border border-opacity-40 bg-gray-100 rounded-md text-justify",children:a.body})]})]})})),Me=C()().subtract(7,"days").toDate(),He=Object(i.d)(Object(d.b)((function(e,t){return{id:t.id,messages:e.firestore.ordered["".concat(t.id,"_selected_messages")],auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{sendMessage:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o,l,i,d,u;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.getFirebase,l=s.getFirestore,o(),i=l(),d=r(),u=null===d||void 0===d||null===(c=d.firebase)||void 0===c||null===(n=c.auth)||void 0===n?void 0:n.uid,t.prev=5,t.next=8,i.collection("harvests").doc(e.harvestId).collection("messages").add({body:e.body,created_at:new Date,sentByOwner:e.sentByOwner,user:i.doc("/users/"+u)});case 8:a({type:O.SEND_MESSAGE_SUCCESS,res:""}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),a({type:O.SEND_MESSAGE_ERROR,err:t.t0});case 14:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))}}})),Object(j.firestoreConnect)((function(e){return[{collection:"harvests",where:[["created_at",">",Me]],orderBy:["created_at","desc"]},{collection:"categories",orderBy:"score"},{collection:"harvests",doc:e.id,storeAs:"selected_harvest"},{collection:"harvests",doc:e.id,subcollections:[{collection:"messages",orderBy:["created_at","desc"]}],storeAs:"".concat(e.id,"_selected_messages")}]})))((function(e){var t=e.id,a=e.messages,r=e.auth,n=e.userId,o=e.profile,l=e.sendMessage,i=Object(c.useState)(!0),d=Object(E.a)(i,2),u=d[0],b=d[1],x=Object(c.useState)(null),h=Object(E.a)(x,2),m=h[0],f=h[1];if(Object(c.useEffect)((function(){Object(j.isLoaded)(a)&&b(!1)}),[a]),u)return Object(s.jsx)("div",{className:"mt-6",children:"Messages Loading.."});return Object(s.jsxs)("div",{className:"flex flex-col space-x-2 mt-6",children:[Object(s.jsx)("div",{className:"border-b font-bold",children:"Messages"}),!Object(j.isEmpty)(r)&&r.uid===n||(null===o||void 0===o?void 0:o.role)?Object(s.jsxs)("div",{className:"flex flex-col items-end",children:[Object(s.jsx)("textarea",{rows:4,className:"p-2 w-full focus:outline-none border rounded-md mt-1",placeholder:"Type your reply here",onChange:function(e){return f(e.target.value)}}),Object(s.jsx)("button",{onClick:function(){l({harvestId:t,body:m,sentByOwner:r.uid===n})},disabled:!m,className:"bg-gray-700 text-white text-sm uppercase font-bold py-2 px-4 my-2 rounded-lg hover:bg-gray-600 focus:outline-none focus:bg-gray-600 ease-out duration-300",children:"Send"})]}):null,a&&a.length>0?Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{className:"mt-6 ",children:a.map((function(e){return Object(s.jsx)(Ie,{message:e},e.id)}))})}):Object(s.jsx)("div",{className:"font-bold text-gray-500 text-center px-2 py-1 m-1 border border-opacity-40 bg-gray-100",children:"There are no messages"})]})})),De=C()().subtract(7,"days").toDate(),Fe=Object(i.d)(Object(d.b)((function(e,t){var a,r,s;return{id:null===(a=t.match)||void 0===a||null===(r=a.params)||void 0===r?void 0:r.id,harvest:e.firestore.ordered.selected_harvest?e.firestore.ordered.selected_harvest[0]:[],categories:null!==(s=e.firestore.ordered.categories)&&void 0!==s?s:[],auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{showAuthModal:function(){return e(se())},setRating:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o,l,i,d;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.getFirebase,l=s.getFirestore,o(),i=l(),null===(d=r())||void 0===d||null===(c=d.firebase)||void 0===c||null===(n=c.auth)||void 0===n||n.uid,t.prev=5,t.next=8,i.collection("harvests").doc(e.harvestId).update({rating:e.rating});case 8:a({type:O.RATE_HARVEST_SUCCESS,res:""}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),a({type:O.RATE_HARVEST_ERROR,err:t.t0});case 14:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))},edit:function(t){return e(function(e){var t=e.key,a=e.value,r=e.harvestId;return function(){var e=Object(U.a)(F.a.mark((function e(s,c,n){var o,l,i,d,u,b;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.getFirebase,d=n.getFirestore,i(),u=d(),null===(b=c())||void 0===b||null===(o=b.firebase)||void 0===o||null===(l=o.auth)||void 0===l||l.uid,e.prev=5,e.next=8,u.collection("harvests").doc(r).update(Object(ae.a)({},t,a));case 8:s({type:O.RATE_HARVEST_SUCCESS,res:""}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),s({type:O.RATE_HARVEST_ERROR,err:e.t0});case 14:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(t))},addNewImage:function(t){return e(function(e){var t=e.image,a=e.harvestId;return function(){var e=Object(U.a)(F.a.mark((function e(r,s,c){var n,o,l,i,d,u,b,j,x,h,m;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=c.getFirebase,i=c.getFirestore,d=l(),u=i(),null===(b=s())||void 0===b||null===(n=b.firebase)||void 0===n||null===(o=n.auth)||void 0===o||o.uid,j=Date.now(),e.prev=6,x=d.storage().ref(),h=x.child("/users/".concat(j,"/harvest_").concat(a,".png")),e.next=11,h.put(t);case 11:return e.next=13,h.getDownloadURL();case 13:return m=e.sent,e.next=16,u.collection("harvests").doc(a).update({images:u.FieldValue.arrayUnion(m)});case 16:r({type:O.EDIT_HARVEST_SUCCESS,res:""}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),console.log(e.t0),r({type:O.EDIT_HARVEST_ERROR,err:e.t0});case 23:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(t))},removeImageByUrl:function(t){return e(function(e){var t=e.imageUrl,a=e.harvestId;return function(){var e=Object(U.a)(F.a.mark((function e(r,s,c){var n,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.getFirebase,n=c.getFirestore,o=n(),e.prev=2,e.next=5,o.collection("harvests").doc(a).update({images:o.FieldValue.arrayRemove(t)});case 5:r({type:O.EDIT_HARVEST_SUCCESS,res:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),r({type:O.EDIT_HARVEST_ERROR,err:e.t0});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(t))},remove:function(t){return e(function(e){var t=e.harvestId;return function(){var e=Object(U.a)(F.a.mark((function e(a,r,s){var c,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.getFirebase,c=s.getFirestore,n=c(),e.prev=2,e.next=5,n.collection("harvests").doc(t).delete();case 5:a({type:O.DELETE_HARVEST_SUCCESS,res:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),a({type:O.DELETE_HARVEST_ERROR,err:e.t0});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(t))}}})),Object(j.firestoreConnect)((function(e){var t,a,r=null===(t=e.match)||void 0===t||null===(a=t.params)||void 0===a?void 0:a.id;return[{collection:"harvests",where:[["created_at",">",De]],orderBy:["created_at","desc"]},{collection:"categories",orderBy:"score"},{collection:"harvests",doc:r,storeAs:"selected_harvest"}]})))((function(e){var t,a=e.harvest,r=e.auth,n=e.showAuthModal,o=e.setRating,l=e.profile,i=e.edit,d=e.remove,u=e.addNewImage,b=e.removeImageByUrl,x=Object(c.useState)(!0),h=Object(E.a)(x,2),m=h[0],f=h[1],O=Object(c.useState)(""),p=Object(E.a)(O,2),g=p[0],v=p[1],y=Object(c.useState)(!1),w=Object(E.a)(y,2),N=w[0],S=w[1],k=Object(c.useState)(!1),_=Object(E.a)(k,2),R=_[0],L=_[1],A=Object(c.useState)(""),T=Object(E.a)(A,2),I=T[0],M=T[1],D=Object(c.useState)(""),V=Object(E.a)(D,2),G=V[0],P=V[1],W=Object(c.useState)(!1),B=Object(E.a)(W,2),z=B[0],J=B[1];if(Object(c.useEffect)((function(){Object(j.isLoaded)(a)&&(f(!1),a.images&&v(a.images[0]),a.farmer&&r.uid===a.farmer.id&&S(!0),M(a.title),P(a.description))}),[r.uid,a]),m)return Object(s.jsxs)("div",{className:"flex w-full h-full flex-col justify-center items-center",children:[Object(s.jsx)("div",{className:"animate-pulse w-10 h-10 text-gray-500 mb-2",children:Object(s.jsx)(X,{})}),Object(s.jsx)("div",{className:"text-md font-lato animate-pulse text-gray-900",children:"Loading"})]});if(Object(j.isEmpty)(a))return Object(s.jsx)("div",{className:"flex w-full h-full flex-col justify-center items-center",children:"Not found"});var Y=function(e){!Object(j.isEmpty)(r)&&(null===l||void 0===l?void 0:l.role)?o({rating:e,harvestId:a.id,ratingBy:r.uid}):alert("Only Keels Staff and DOA staff can set rating")},Z=function(){var e=Object(U.a)(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z){e.next=2;break}return e.abrupt("return");case 2:if(!t.target.files){e.next=7;break}return J(!0),e.next=6,u({image:t.target.files[0],harvestId:a.id});case 6:J(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"flex w-full h-full",children:[Object(s.jsx)("div",{className:"flex-1 flex pr-4 flex-col h-full overflow-y-auto ",children:Object(s.jsxs)("div",{className:"h-full flex flex-col",children:[Object(s.jsx)("div",{className:"flex-1 bg-gray-300 bg-cover bg-center rounded-lg mb-2",style:{backgroundImage:'url("'.concat(g,'")')}}),a&&a.images&&(a.images.length>1||N)?Object(s.jsxs)("div",{className:"h-64 w-full flex flex-row overflow-y-hidden overflow-x-auto pb-2 space-x-2",children:[a.images.map((function(e){return Object(s.jsx)("div",{className:"w-60 h-60 hover:border-green-600 border-2 ease-out duration-300 square relative bg-gray-400 rounded-lg bg-center bg-cover",style:{backgroundImage:'url("'.concat(e,'")')},onClick:function(){return v(e)},children:N?Object(s.jsx)("div",{className:"absolute top-1 right-1 font-bold px-2 py-1 cursor-pointer bg-gray-700 rounded select-none text-gray-50",onClick:function(){window.confirm("Are you sure")&&b({imageUrl:e,harvestId:a.id})},children:"Remove"}):null})})),N?Object(s.jsxs)("label",{htmlFor:"addImage",className:"w-60 flex-grow-0 flex cursor-pointer justify-center items-center hover:border-gray-500 hover:text-gray-500 border-2 border-dashed border-gray-300 text-gray-300 ease-out duration-300 square bg-gray-50 rounded-lg",children:[z?Object(s.jsx)("div",{className:"w-10 h-10 text-gray-500 ",children:Object(s.jsx)(X,{})}):Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-20 h-20",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),z?"Uploading":"Add new photo",Object(s.jsx)("input",{id:"addImage",type:"file",accept:".png, .jpg",onChange:Z,hidden:!0})]}):null]}):null]})}),Object(s.jsxs)("div",{className:"flex-1 pl-4 pr-4 h-full overflow-y-auto",children:[Object(s.jsx)("div",{className:"text-3xl font-bold text-gray-700 mb-1",children:R?Object(s.jsx)("textarea",{defaultValue:a.title,className:"border w-full p-1 rounded",autoFocus:!0,onChange:function(e){return M(e.target.value)}}):a.title}),Object(s.jsxs)("div",{className:"flex flex-row justify-between items-end mt-4 mb-2",children:[Object(j.isEmpty)(r)?null:Object(s.jsx)(Te,{id:a.farmer.id,address:Object(s.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps/search/".concat(a.location.latitude,",").concat(a.location.longitude),className:"text-md text-gray-400 hover:underline",children:"".concat(Object(j.isEmpty)(r)?"":"".concat(a.address.street,", ")," ").concat(a.address.city,", ").concat(a.address.province," ")})}),Object(s.jsxs)("div",{className:"flex flex-col items-end",children:[N?Object(s.jsxs)("div",{className:"flex flex-row space-x-1",children:[Object(s.jsx)("div",{onClick:function(){I?G?(i({key:"title",value:I,harvestId:a.id}),i({key:"description",value:G,harvestId:a.id}),L(!R)):alert("description cannot be empty"):alert("Title cannot be empty")},className:"text-sm py-1 px-2 bg-gray-700 rounded select-none text-gray-50 text-left hover:underline cursor-pointer",children:R?"Save":"Edit"}),R?null:Object(s.jsx)("div",{onClick:function(){window.confirm("Action cannot be undone! Are you sure?")&&d({harvestId:a.id})},className:"text-sm py-1 px-2 bg-gray-700 rounded select-none text-gray-50 text-left hover:underline cursor-pointer",children:"Delete"})]}):null,Object(s.jsx)("div",{className:"text-sm text-gray-400",children:"Posted ".concat(C()(a.created_at.toDate()).fromNow())})]})]}),Object(s.jsx)("div",{className:"mt-4 text-justify",children:R?Object(s.jsx)("textarea",{defaultValue:a.description,className:"border w-full p-1 rounded",rows:5,onChange:function(e){return P(e.target.value)}}):a.description}),Object(s.jsxs)("div",{className:"mt-4 flex flex-row items-center space-x-1",children:[Object(s.jsx)("div",{className:"font-bold",children:"Rating:"}),Object(H.a)(Array(5)).map((function(e,t){var r;return(null!==(r=a.rating)&&void 0!==r?r:0)>t?Object(s.jsx)("div",{className:"w-6 h-6 cursor-pointer",onClick:function(){return Y(t+1)},children:Object(s.jsx)(K,{colorClass:"text-yellow-500"})}):Object(s.jsx)("div",{className:"w-5 h-5 hover:text-gray-700 cursor-pointer",onClick:function(){return Y(t+1)},children:Object(s.jsx)(q,{})})})),Object(s.jsx)("div",{className:"",children:"".concat(null!==(t=a.rating)&&void 0!==t?t:0,"x")})]}),Object(j.isEmpty)(r)?Object(s.jsx)("div",{onClick:function(){return n()},className:"mt-4 font-bold text-gray-500 text-center px-2 py-1 m-1 border border-opacity-40 bg-gray-100",children:"Please sign in to get more information"}):Object(s.jsx)(He,{id:a.id,userId:a.farmer.id})]})]})})),Ue=a(160),Ve=C()().subtract(7,"days").toDate(),Ge=Object(i.d)(Object(d.b)((function(e){var t,a,r,s;return{added_last_7_days:null!==(t=e.firestore.ordered.added_last_7_days)&&void 0!==t?t:[],wasted_harvest:null!==(a=e.firestore.ordered.wasted_harvest)&&void 0!==a?a:[],users:null!==(r=e.firestore.ordered.users)&&void 0!==r?r:[],categories:null!==(s=e.firestore.ordered.categories)&&void 0!==s?s:[],auth:e.firebase.auth}}),(function(e){return{}})),Object(j.firestoreConnect)((function(e){return[{collection:"harvests",where:[["created_at",">",Ve]],orderBy:["created_at","desc"],storeAs:"added_last_7_days"},{collection:"harvests",where:[["created_at","<=",Ve]],orderBy:["created_at","desc"],storeAs:"wasted_harvest"},{collection:"categories",orderBy:"score"},{collection:"users"}]})))((function(e){var t=Object(c.useState)({datasets:[{data:[0,0,0],backgroundColor:["#47464A","#FDB45C","#46BF9D"]}],labels:["Grains","Fruits","Vegetables"]}),a=Object(E.a)(t,2),r=a[0],n=a[1],o=Object(c.useState)({datasets:[{label:"Users",backgroundColor:"rgba(75,192,192,1)",borderColor:"rgba(0,0,0,1)",borderWidth:2,data:[0,e.users.length,0]}],labels:["Dec","Jan","Feb"]}),l=Object(E.a)(o,2),i=l[0],d=(l[1],Object(c.useState)(!0)),u=Object(E.a)(d,2),b=u[0],x=u[1],h=Object(c.useState)({Jaffna:0,Kilinochchi:0,Mannar:0,Mullaitivu:0,Vavuniya:0,Puttalam:0,Kurunegala:0,Gampaha:0,Colombo:0,Kalutara:0,Anuradhapura:0,Polonnaruwa:0,Matale:0,Kandy:0,Nuwara_Eliya:0,Kegalle:0,Ratnapura:0,Trincomalee:0,Batticaloa:0,Ampara:0,Badulla:0,Monaragala:0,Hambantota:0,Matara:0,Galle:0}),m=Object(E.a)(h,2),f=m[0],O=m[1],p=Object(c.useState)(!1),g=Object(E.a)(p,2),v=g[0],y=g[1];Object(c.useEffect)((function(){if(Object(j.isLoaded)(e.added_last_7_days,e.wasted_harvest,e.users)&&(x(!1),!v)){for(var t=r,a=f,s=0;s<e.added_last_7_days.length;s++){var c=e.added_last_7_days[s];switch(c.categories[0].id){case"lx2ip2EX2SiSP9XNbtHb":t.datasets[0].data[0]+=1;break;case"iGWbWHqL272OeuMqnqu9":t.datasets[0].data[1]+=1;break;case"q0IX8qPY3gNhgkoAkq1k":t.datasets[0].data[2]+=1}a[c.address.city]+=1,y(!0)}O(a),n(t)}}),[v,r,r.datasets,i,f,e.added_last_7_days,e.users,e.wasted_harvest]);return Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"flex items- min-h-screen bg-gray-50 text-gray-800",children:Object(s.jsxs)("div",{className:"flex flex-col p-4 w-full",children:[Object(s.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[Object(s.jsx)("div",{className:"col-span-12 sm:col-span-6 md:col-span-3",children:Object(s.jsxs)("div",{className:"flex flex-row bg-white shadow-sm rounded p-4",children:[Object(s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 h-12 w-12 rounded-xl bg-blue-100 text-blue-500",children:Object(s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),Object(s.jsxs)("div",{className:"flex flex-col flex-grow ml-4",children:[Object(s.jsx)("div",{className:"text-sm text-gray-500",children:"Users"}),Object(s.jsx)("div",{className:"font-bold text-lg",children:e.users.length})]})]})}),Object(s.jsx)("div",{className:"col-span-12 sm:col-span-6 md:col-span-3",children:Object(s.jsxs)("div",{className:"flex flex-row bg-white shadow-sm rounded p-4",children:[Object(s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 h-12 w-12 rounded-xl bg-green-100 text-green-500",children:Object(s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),Object(s.jsxs)("div",{className:"flex flex-col flex-grow ml-4",children:[Object(s.jsx)("div",{className:"text-sm text-gray-500",children:"New Harvests (this week)"}),Object(s.jsx)("div",{className:"font-bold text-lg",children:e.added_last_7_days.length})]})]})}),Object(s.jsx)("div",{className:"col-span-12 sm:col-span-6 md:col-span-3",children:Object(s.jsxs)("div",{className:"flex flex-row bg-white shadow-sm rounded p-4",children:[Object(s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 h-12 w-12 rounded-xl bg-orange-100 text-orange-500",children:Object(s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),Object(s.jsxs)("div",{className:"flex flex-col flex-grow ml-4",children:[Object(s.jsx)("div",{className:"text-sm text-gray-500",children:"Categories"}),Object(s.jsx)("div",{className:"font-bold text-lg",children:e.categories.length})]})]})}),Object(s.jsx)("div",{className:"col-span-12 sm:col-span-6 md:col-span-3",children:Object(s.jsxs)("div",{className:"flex flex-row bg-white shadow-sm rounded p-4",children:[Object(s.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 h-12 w-12 rounded-xl bg-red-100 text-red-500",children:Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),Object(s.jsxs)("div",{className:"flex flex-col flex-grow ml-4",children:[Object(s.jsx)("div",{className:"text-sm text-gray-500",children:"Wasted Harvest"}),Object(s.jsx)("div",{className:"font-bold text-lg",children:e.wasted_harvest.length})]})]})})]}),Object(s.jsxs)("div",{className:"flex flex-row space-x-2 mt-2",children:[Object(s.jsx)("div",{className:"flex-1",children:Object(s.jsxs)("div",{className:"flex flex-col bg-white shadow-sm rounded p-4",children:[Object(s.jsx)("div",{className:"block text-gray-700 text-lg font-semibold py-2 px-2",children:"District wise harvests"}),function(){var e=[];for(var t in f)e.push(Object(s.jsxs)("div",{className:"flex flex-row space-x-2 justify-between w-32 mb-1",children:[Object(s.jsx)("div",{children:"".concat(t)}),Object(s.jsxs)("div",{children:["".concat(f[t])," "]})]}));return e}()]})}),Object(s.jsxs)("div",{className:"flex-1 flex flex-col",children:[Object(s.jsx)("div",{className:"",children:Object(s.jsxs)("div",{className:"bg-white shadow-md rounded-lg px-3 py-2 mb-4",children:[Object(s.jsx)("div",{className:"block text-gray-700 text-lg font-semibold py-2 px-2",children:"Percentage"}),Object(s.jsx)("div",{className:"p1-3 text-sm h-72",children:b?null:Object(s.jsx)(Ue.Doughnut,{width:100,height:50,options:{maintainAspectRatio:!1},data:r})})]})}),Object(s.jsx)("div",{className:"",children:Object(s.jsxs)("div",{className:"bg-white shadow-md rounded-lg px-3 py-2",children:[Object(s.jsx)("div",{className:"text-gray-700 text-lg font-semibold py-2 px-2",children:"Users"}),Object(s.jsx)("div",{className:"text-sm ",children:Object(s.jsx)(Ue.Bar,{height:127.5,data:i})})]})})]})]})]})})})})),Pe=function(e){var t=e.id,a=e.labelText,r=e.name,c=e.type,n=e.required,o=void 0!==n&&n,l=e.tooltipText,i=e.onChange,d=e.validationError,u=void 0!==d&&d,b=e.disabled,j=void 0!==b&&b,x=e.autoFocus,h=void 0!==x&&x,m=e.minLength,f=void 0===m?0:m,O=e.maxLength,p=void 0===O?100:O,g=(e.defaultValue,e.placeholder),v=void 0===g?"":g,y=e.value;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"flex justify-between items-center",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:t,children:a}),Object(s.jsx)("div",{className:"mb-2 text-xs text-gray-500 hover:text-gray-800 focus:outline-none cursor-pointer",children:l?Object(s.jsx)(we,{tooltipText:l,children:Object(s.jsx)("div",{className:"w-4 h-4",children:Object(s.jsx)(J,{strokeWidth:2})})}):null})]}),Object(s.jsx)("input",{id:t,name:r,className:" ".concat(u?"ring-red-400 ring-2 border-red-500":"focus:border-gray-500 focus:ring-gray-300 focus:ring "," bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-4 block w-full transition-all ease-out duration-300"),type:c,onChange:i,disabled:j,autoFocus:h,required:o,minLength:f,maxLength:p,value:y,placeholder:v})]})},We=["Northern","North_Western","Western","North_Central","Central","Sabaragamuwa","Eastern","Uva","Southern"],Be={Northern:["Jaffna","Kilinochchi","Mannar","Mullaitivu","Vavuniya"],North_Western:["Puttalam","Kurunegala"],Western:["Gampaha","Colombo","Kalutara"],North_Central:["Anuradhapura","Polonnaruwa"],Central:["Matale","Kandy","Nuwara_Eliya"],Sabaragamuwa:["Kegalle","Ratnapura"],Eastern:["Trincomalee","Batticaloa","Ampara"],Uva:["Badulla","Monaragala"],Southern:["Hambantota","Matara","Galle"]},ze={Jaffna:[9.66845,80.00742],Kilinochchi:[9.3803,80.377],Mannar:[8.981,79.9044],Mullaitivu:[9.2671,80.8142],Vavuniya:[8.7542,80.4982],Puttalam:[8.0408,79.8394],Kurunegala:[7.4818,80.3609],Gampaha:[7.084,80.0098],Colombo:[6.9271,79.8612],Kalutara:[6.5854,79.9607],Anuradhapura:[8.3114,80.4037],Polonnaruwa:[7.9403,81.0188],Matale:[7.4675,80.6234],Kandy:[7.2906,80.6337],Nuwara_Eliya:[6.9497,80.7891],Kegalle:[7.2513,80.3464],Ratnapura:[6.7056,80.3847],Trincomalee:[8.5874,81.2152],Batticaloa:[7.731,81.6747],Ampara:[7.3018,81.6747],Badulla:[6.9934,81.055],Monaragala:[6.8728,81.3507],Hambantota:[6.1429,81.1212],Matara:[5.9549,80.555],Galle:[6.0535,80.221]},qe=Object(i.d)(Object(d.b)((function(e){var t;return{authError:e.auth.authError,categories:null!==(t=e.firestore.ordered.categories)&&void 0!==t?t:[]}}),(function(e){return{hideHarvestModal:function(){return e((function(e){e({type:O.HIDE_HARVEST_MODAL})}))},showHarvestModal:function(){return e(ne())},addHarvest:function(t){return e(function(e){return function(){var t=Object(U.a)(F.a.mark((function t(a,r,s){var c,n,o,l,i,d,u,b,j,x,h,m,f,p,g,v;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=s.getFirebase,l=s.getFirestore,i=o(),d=l(),u=r(),b=Date.now(),j=null===u||void 0===u||null===(c=u.firebase)||void 0===c||null===(n=c.auth)||void 0===n?void 0:n.uid,x=[],h=[],m=i.storage().ref(),f=0;f<e.files.length;f++)x.push(m.child("/users/".concat(b,"/harvest_").concat(f,".png")));p=0;case 11:if(!(p<e.files.length)){t.next=17;break}return t.next=14,x[p].put(e.files[p]);case 14:p++,t.next=11;break;case 17:g=0;case 18:if(!(g<e.files.length)){t.next=26;break}return t.next=21,x[g].getDownloadURL();case 21:v=t.sent,h.push(v);case 23:g++,t.next=18;break;case 26:return t.prev=26,t.next=29,d.collection("harvests").add({address:{city:e.selectedDistrict,province:e.selectedProvince,street:e.street},categories:[d.doc("/categories/"+e.categoryId)],created_at:new Date,description:e.description,farmer:d.doc("/users/"+j),images:h,location:new d.GeoPoint(e.latitude,e.longitude),mapIconType:e.iconType,title:e.title});case 29:a({type:O.ADD_HARVEST_SUCCESS,res:""}),t.next=36;break;case 32:t.prev=32,t.t0=t.catch(26),console.log(t.t0),a({type:O.ADD_HARVEST_ERROR,err:t.t0});case 36:case"end":return t.stop()}}),t,null,[[26,32]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t))}}})),Object(j.firestoreConnect)((function(e){return[{collection:"categories",orderBy:"score"}]})))((function(e){var t=Object(c.useState)(!1),a=Object(E.a)(t,2),r=a[0],n=a[1];Object(c.useEffect)((function(){Object(j.isLoaded)(e.categories)&&n(!1)}),[e.categories]);var o=Object(c.useState)(We[0]),l=Object(E.a)(o,2),i=l[0],d=l[1],u=Object(c.useState)(Be[We[0]][0]),b=Object(E.a)(u,2),x=b[0],h=b[1],m=Object(c.useState)(ze[Be[We[0]][0]][0]),f=Object(E.a)(m,2),O=(f[0],f[1]),p=Object(c.useState)(ze[Be[We[0]][0]][1]),g=Object(E.a)(p,2),v=(g[0],g[1]),y=Object(c.useState)(""),w=Object(E.a)(y,2),N=w[0],S=w[1],C=Object(c.useState)(""),k=Object(E.a)(C,2),_=k[0],R=k[1],L=Object(c.useState)(""),A=Object(E.a)(L,2),T=A[0],I=A[1],M=Object(c.useState)(""),H=Object(E.a)(M,2),D=H[0],F=H[1],U=Object(c.useState)("vegetableIcon"),V=Object(E.a)(U,2),G=V[0],P=V[1],W=Object(c.useState)([]),B=Object(E.a)(W,2),z=B[0],q=B[1];return Object(s.jsxs)("div",{className:"w-screen h-screen absolute z-20 flex flex-col items-center justify-center",children:[Object(s.jsxs)("div",{style:{width:"30rem"},className:"bg-gray-50 rounded-lg shadow-lg p-4 z-20",children:[Object(s.jsx)("button",{onClick:function(){return e.hideHarvestModal()},className:"absolute bg-gray-100 w-8 h-8 top-0 right-0 rounded-lg flex items-center hover:shadow-md justify-center transition-all ease-out duration-400 focus:outline-none",children:"\ud83d\uddd9"}),Object(s.jsx)("p",{className:"text-xl text-gray-600 text-center font-bold",children:"Add new harvest"}),Object(s.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[Object(s.jsx)("span",{className:"border-b w-1/6 lg:w-1/6"}),Object(s.jsx)("span",{className:"text-xs text-center text-gray-500 uppercase",children:"Please fill these information"}),Object(s.jsx)("span",{className:"border-b w-1/6 lg:w-1/6"})]}),Object(s.jsxs)("form",{onSubmit:function(t){t.preventDefault(),n(!0),e.addHarvest({selectedDistrict:x,selectedProvince:i,street:T,iconType:G,latitude:ze[x][0],longitude:ze[x][1],title:N,description:_,categoryId:D,files:z})},children:[Object(s.jsx)("div",{className:"mt-2",children:Object(s.jsx)(Ne,{id:"title",labelText:"Title",name:"title",type:"text",required:!0,disabled:r,onChange:function(e){S(e.target.value)},validationError:!1,autoFocus:!0})}),Object(s.jsx)("div",{className:"mt-2",children:Object(s.jsx)(Ne,{id:"description",labelText:"Description",name:"description",type:"text",required:!0,disabled:r,onChange:function(e){R(e.target.value)},validationError:!1})}),Object(s.jsx)("div",{className:"mt-1",children:Object(s.jsx)(Ne,{id:"street",labelText:"Street Address",name:"street",type:"text",required:!0,disabled:r,onChange:function(e){I(e.target.value)},validationError:!1})}),Object(s.jsxs)("div",{className:"mt-2 flex space-x-2",children:[Object(s.jsxs)("div",{className:"w-1/2",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:"provinceSelect",children:"Province"}),Object(s.jsx)("select",{className:"bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-2 block w-full transition-all ease-out duration-300",id:"provinceSelect",onChange:function(e){return d(e.target.value)},children:We.map((function(e){return Object(s.jsx)("option",{value:e,children:e})}))})]}),Object(s.jsxs)("div",{className:"w-1/2",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:"districtSelect",children:"District"}),Object(s.jsx)("select",{className:"bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-2 block w-full transition-all ease-out duration-300",id:"districtSelect",onChange:function(e){return h(e.target.value)},children:Be[i].map((function(e){return Object(s.jsx)("option",{value:e,children:e})}))})]})]}),Object(s.jsxs)("div",{className:"mt-2 flex space-x-2",children:[Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Pe,{id:"latitude",labelText:"Latitude",name:"latitude",type:"text",required:!0,disabled:r,onChange:function(e){O(e.target.value)},validationError:!1,value:ze[x][0]})}),Object(s.jsx)("div",{className:"w-1/2",children:Object(s.jsx)(Pe,{id:"longitude",labelText:"Longitude",name:"longitude",type:"text",required:!0,disabled:r,onChange:function(e){v(e.target.value)},validationError:!1,value:ze[x][1]})})]}),Object(s.jsxs)("div",{className:"mt-2",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:"districtSelect",children:"Category"}),Object(s.jsxs)("select",{className:"bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-2 block w-full transition-all ease-out duration-300",id:"category",required:!0,onChange:function(e){return F(e.target.value)},children:[Object(s.jsx)("option",{disabled:!0,selected:!0,value:!0,children:"-- select a category --"}),e.categories&&e.categories.map((function(e){return Object(s.jsx)("option",{value:e.id,children:e.name})}))]})]}),Object(s.jsxs)("div",{className:"mt-2",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:"iconType",children:"Icon Type"}),Object(s.jsxs)("select",{className:"bg-white text-gray-700 border border-gray-300 focus:outline-none rounded-lg py-2 px-2 block w-full transition-all ease-out duration-300",id:"iconType",onChange:function(e){return P(e.target.value)},children:[Object(s.jsx)("option",{value:"vegetableIcon",children:"Vegetable Icon"}),Object(s.jsx)("option",{value:"fruitIcon",children:"Fruit Icon"}),Object(s.jsx)("option",{value:"grainsIcon",children:"Grains Icon"}),Object(s.jsx)("option",{value:"otherIcon",children:"Other Icon"})]})]}),Object(s.jsxs)("div",{className:"mt-2",children:[Object(s.jsx)("label",{className:"block text-gray-600 text-sm font-medium mb-2",htmlFor:"selectFiles",children:"Pictures"}),Object(s.jsx)("input",{type:"file",id:"selectFiles",onChange:function(e){e.target.files&&q(e.target.files)},multiple:!0,required:!0})]}),Object(s.jsx)("div",{className:"mt-6",children:Object(s.jsx)("button",{disabled:r,type:"submit",className:"bg-gray-700 text-white uppercase font-bold py-2 px-4 w-full rounded-lg hover:bg-gray-600 focus:outline-none focus:bg-gray-600 ease-out duration-300",children:r?Object(s.jsx)("div",{className:"w-6 h-6 mx-auto",children:Object(s.jsx)(X,{colorClass:"text-gray-300"})}):"ADD"})})]})]}),Object(s.jsx)("div",{className:"w-screen h-screen absolute bg-black opacity-40"})]})})),Ke=Object(i.d)(Object(d.b)((function(e){var t;return{users:null!==(t=e.firestore.ordered.users)&&void 0!==t?t:[],auth:e.firebase.auth}}),(function(e){return{setRole:function(t){return e(function(e){var t=e.value,a=e.userId;return function(){var e=Object(U.a)(F.a.mark((function e(r,s,c){var n,o,l;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.getFirebase,o=c.getFirestore,n(),l=o(),s(),e.prev=4,e.next=7,l.collection("users").doc(a).update({role:t});case 7:r({type:O.RATE_HARVEST_SUCCESS,res:""}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),r({type:O.RATE_HARVEST_ERROR,err:e.t0});case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t,a,r){return e.apply(this,arguments)}}()}(t))}}})),Object(j.firestoreConnect)((function(e){return[{collection:"users"}]})))((function(e){var t=e.users,a=e.setRole;return Object(s.jsxs)("div",{className:"flex flex-col",children:[Object(s.jsx)("div",{className:"text-lg font-bold",children:"Users"}),Object(s.jsxs)("table",{className:"border min-w-full mt-4",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{className:"px-6 py-3 border-b-2 border-gray-300 text-left leading-4 text-gray-700 tracking-wider",children:"ID"}),Object(s.jsx)("th",{className:"px-6 py-3 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-700 tracking-wider",children:"Name"}),Object(s.jsx)("th",{className:"px-6 py-3 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-700 tracking-wider",children:"NIC"}),Object(s.jsx)("th",{className:"px-6 py-3 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-700 tracking-wider",children:"Phone"}),Object(s.jsx)("th",{className:"px-6 py-3 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-700 tracking-wider",children:"Role"})]})}),Object(s.jsx)("tbody",{children:t&&t.map((function(e){var t;return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"px-6 py-4 whitespace-no-wrap border-b text-gray-900 border-gray-500 text-sm leading-5",children:e.id}),Object(s.jsx)("td",{className:"px-6 py-4 whitespace-no-wrap border-b text-gray-900 border-gray-500 text-sm leading-5",children:"".concat(e.firstName," ").concat(e.lastName)}),Object(s.jsx)("td",{className:"px-6 py-4 whitespace-no-wrap border-b text-gray-900 border-gray-500 text-sm leading-5",children:e.nic}),Object(s.jsx)("td",{className:"px-6 py-4 whitespace-no-wrap border-b text-gray-900 border-gray-500 text-sm leading-5",children:e.phone}),Object(s.jsx)("td",{className:"px-6 py-4 whitespace-no-wrap border-b text-gray-900 border-gray-500 text-sm leading-5",children:Object(s.jsxs)("select",{defaultValue:null!==(t=e.role)&&void 0!==t?t:"FARMER",onChange:function(t){return a({value:t.target.value,userId:e.id})},children:[Object(s.jsx)("option",{value:"DOA",children:"DOA"}),Object(s.jsx)("option",{value:"KEELS",children:"KEELS"}),Object(s.jsx)("option",{value:"FARMER",children:"FARMER"}),Object(s.jsx)("option",{value:"ADMIN",children:"ADMIN"})]})})]},e.id)}))})]})]})}));var Je=Object(d.b)((function(e){return{auth:e.firebase.auth,authModalVisible:e.auth.authModalVisible,harvestModalVisible:e.auth.harvestModalVisible,profile:e.firebase.profile}}))((function(e){var t=e.auth,a=e.profile,r=e.authModalVisible,n=e.harvestModalVisible,o=Object(j.isLoaded)(t,a),l=Object(c.useContext)(y.d).location,i=Object(w.d)(l,(function(e){return e.pathname}),{from:{opacity:0,transform:"translate(5%,0)",position:"absolute",width:"100%"},enter:{opacity:1,transform:"translate(0,0)",position:"relative",width:"100%"},leave:{opacity:0,transform:"translate(-5%,0)",position:"absolute",width:"100%"}}),d=Object(w.b)({opacity:o?0:1,height:o?"0vh":"100vh",overflow:"hidden",position:"absolute",zIndex:999}),u=Object(w.d)(r,null,{from:{opacity:0,backdropFilter:"blur(0px)"},enter:{opacity:1,backdropFilter:"blur(5px)"},leave:{opacity:0,backdropFilter:"blur(0px)"}}),b=Object(w.d)(n,null,{from:{opacity:0,backdropFilter:"blur(0px)"},enter:{opacity:1,backdropFilter:"blur(5px)"},leave:{opacity:0,backdropFilter:"blur(0px)"}});return Object(s.jsxs)("div",{className:"flex justify-center bg-gray-900",children:[Object(s.jsx)(f.a,{position:"top-center",toastClassName:"rounded-lg"}),Object(s.jsx)(w.a.div,{style:d,children:Object(s.jsx)(Le,{authLoaded:Object(j.isLoaded)(t),profileLoaded:Object(j.isLoaded)(a)})}),Object(j.isEmpty)(t)||void 0!==a.profileCompleted?null:Object(s.jsx)(Ae,{auth:t}),u.map((function(e){var t=e.item,a=e.key,r=e.props;return t&&Object(s.jsx)(w.a.div,{style:r,className:"w-screen h-screen absolute z-20",children:Object(s.jsx)(Re,{})},a)})),b.map((function(e){var t=e.item,a=e.key,r=e.props;return t&&Object(s.jsx)(w.a.div,{style:r,className:"w-screen h-screen absolute z-20",children:Object(s.jsx)(qe,{})},a)})),Object(s.jsxs)("div",{style:{width:"1600px"},className:" h-screen py-2 pr-2 rounded-lg bg-gray-50 flex relative overflow-hidden",children:[Object(s.jsx)(ye,{auth:t,profile:a}),i.map((function(e){var t=e.item,a=e.props,r=e.key;return Object(s.jsx)(w.a.div,{style:a,className:"flex-1 flex-col overflow-y-auto bg-gray-50",children:Object(s.jsxs)(y.c,{location:t,children:[Object(s.jsx)(y.a,{path:"/",component:de,exact:!0}),Object(s.jsx)(y.a,{path:"/harvest/:id",component:Fe}),Object(s.jsx)(y.a,{path:"/profile",component:fe}),Object(s.jsx)(y.a,{path:"/graphs",component:Ge}),Object(s.jsx)(y.a,{path:"/settings",component:Ke}),Object(s.jsx)(y.a,{path:"*",component:function(){return Object(s.jsx)("div",{children:"Not found"})}})]})},r)}))]})]})})),Xe=Object(i.e)(v,Object(i.d)(Object(i.a)(u.a.withExtraArgument({getFirestore:b.getFirestore,getFirebase:j.getFirebase})),Object(b.reduxFirestore)(h))),Ye={firebase:x.a,config:Object(r.a)(Object(r.a)({},h),{userProfile:"users",useFirestoreForProfile:!0,enableRedirectHandling:!1,resetBeforeLogin:!1,enableClaims:!0}),dispatch:Xe.dispatch,createFirestoreInstance:b.createFirestoreInstance};l.a.render(Object(s.jsx)(d.a,{store:Xe,children:Object(s.jsx)(j.ReactReduxFirebaseProvider,Object(r.a)(Object(r.a)({},Ye),{},{children:Object(s.jsx)(ee.a,{basename:"/web-y2-s1-assignment/",children:Object(s.jsx)(Je,{})})}))}),document.getElementById("root")),m(console.log)}},[[434,1,2]]]);
//# sourceMappingURL=main.8f99e901.chunk.js.map